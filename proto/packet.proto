syntax = "proto3";

package packet;

service AgentService {
  rpc StreamPackets (stream PacketBatch) returns (Empty) {}
  rpc Subscribe (Empty) returns (stream PacketBatch) {}
}

message Empty {}

message PacketBatch {
  repeated Packet packets = 1;
}

message Packet {
  bytes src_ip = 1;
  bytes dst_ip = 2;
  bool src_is_agent = 3;
  bool dst_is_agent = 4;
  int32 size = 5;
  Protocol proto = 6;
  int32 src_port = 7;
  int32 dst_port = 8;
}

enum Protocol {
  UNKNOWN = 0;
  TCP = 1;
  UDP = 2;
  ICMP = 3;
  OTHER = 4;
}
